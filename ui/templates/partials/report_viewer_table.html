<div class="flex flex-wrap items-center justify-between gap-3">
  <div class="text-xs font-semibold uppercase tracking-widest text-blueGray-300">
    {{ findings|length if findings else 0 }} record{{ '' if findings and findings|length == 1 else 's' }}
  </div>
  <a
    class="inline-flex items-center gap-2 rounded-lg border border-blueGray-200 bg-white px-3 py-2 text-xs font-semibold text-blueGray-600 shadow-sm transition hover:border-blue-400 hover:text-blue-700"
    href="/ui/reports/{{ report_id }}/viewer/csv{% if severity or rule_contains %}?{% endif %}{% if severity %}severity={{ severity }}{% endif %}{% if severity and rule_contains %}&{% endif %}{% if rule_contains %}rule_contains={{ rule_contains_enc }}{% endif %}"
  >
    <i class="fas fa-file-download text-[11px]"></i>
    Download filtered CSV
  </a>
</div>
{% if findings and findings|length > 0 %}
  <div class="tm-table-wrapper mt-4">
    <table class="tm-table">
      <thead>
        <tr>
          <th>Severity</th>
          <th>Rule</th>
          <th>Title</th>
          <th>File</th>
          <th>Line</th>
        </tr>
      </thead>
      <tbody>
        {% for f in findings %}
          {% set sev = (f.severity or 'LOW')|upper %}
          <tr>
            <td>
              <span class="tm-tag tm-tag-{{ sev|lower }}">{{ sev }}</span>
            </td>
            <td><code class="rounded bg-blueGray-50 px-2 py-1 text-xs text-blueGray-500">{{ f.rule }}</code></td>
            <td class="font-semibold text-blueGray-600">{{ f.title }}</td>
            <td class="text-sm text-blueGray-400">{{ f.file }}</td>
            <td class="text-sm text-blueGray-500">{{ f.line or 1 }}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
{% else %}
  <div class="mt-6 rounded-2xl border border-dashed border-blueGray-200 bg-blueGray-50 px-6 py-8 text-center text-sm text-blueGray-400">
    No findings with the current filters.
  </div>
{% endif %}
